# 変更履歴

## [2.0.0] - 2025-10-25

### 🎉 メジャーアップデート: メディアテンプレート対応

### 追加
- **拡張版簡易フロー**: タイトル+カバー写真で表紙PDF即座生成、その後見開き・単一ページ画像を収集して完全版PDF生成
- **メディアテンプレートシステム**: スキーマ駆動のテンプレートシステムを導入
- **`memoir_vertical` テンプレート**: 自分史_縦書き（表紙+見開き+単一ページ、計4ページ）
- **メディアテンプレート専用編集画面** (`liff/edit-media.html`): 見開きページと単一ページのテキスト編集
- **新規APIエンドポイント**:
  - `GET /api/memoir/edit-media/{session_id}`: メディアテンプレート編集データ取得
  - `POST /api/memoir/save-media/{session_id}`: メディアテンプレート保存＆PDF再生成
- **新規サービス**:
  - `media_template_schema.py`: メディアテンプレートのスキーマ定義
  - `media_memoir_service.py`: メディアフロー管理（将来的に統合予定）

### 変更
- **`quick_memoir_service.py`**: 拡張版に対応
  - `spread_image_url`, `single_image_url` フィールド追加
  - `generate_quick_pdf()` に `full_version` パラメータ追加
  - `_prepare_media_template_data()` メソッド追加
- **`line_service.py`**: 新しいフローに対応
  - カバー写真受信時に表紙PDF生成
  - 見開き画像、単一ページ画像の処理追加
  - 完全版PDF生成フローの統合
- **編集画面URL**: `/liff/edit.html` → `/liff/edit-media.html` (メディアテンプレート用)

### ドキュメント
- **新規**: `extended-quick-flow-guide.md` - 拡張版簡易フローの完全ガイド
- **新規**: `media-template-guide.md` - メディアテンプレートシステムの完全ガイド
- **更新**: `README.md` - 最新の実装内容を反映、バージョン2.0.0に更新
- **更新**: `quick-flow-guide.md` - 参考用として古い情報であることを明記
- **更新**: `design.md` - 参考用として古い情報であることを明記

### 削除
- メディアテンプレート直接トリガー（簡易フローに統一）
- 重複する入口（すべて「作成」キーワードに統一）

### 技術的改善
- 2段階PDF生成による早期フィードバック
- メディアテンプレートのJinja2統合
- スキーマ駆動のデータ構造

---

## [1.0.0] - 2025-10-25

### 初回リリース

### 追加
- **簡易フロー**: タイトル+カバー写真でPDF生成
- **Vivliostyle統合**: HTML→PDF変換
- **画像処理最適化**: ローカルファイル直接コピー（30秒→3秒）
- **編集画面**: プロフィールと年表の編集
- **Flex Message**: 美しい完成通知

### 技術スタック
- Python 3.9+ / FastAPI
- LINE Messaging API
- Vivliostyle CLI
- Jinja2
- OpenAI API

---

## 今後の予定

### v2.1.0 (予定)
- [ ] AI文章生成機能の統合
- [ ] 音声入力対応
- [ ] ページ追加・削除機能

### v3.0.0 (予定)
- [ ] 新しいメディアタイプ
  - 旅ログ_横書き
  - 推しログ_縦書き
  - レシピブック_横書き
- [ ] スキーマ駆動の動的編集画面
- [ ] LIFF本格統合

---

**記法**:
- 🎉 メジャーアップデート
- ✨ 新機能
- 🐛 バグ修正
- 📝 ドキュメント
- ⚡ パフォーマンス改善
- 🔧 技術的変更
- ❌ 削除


